{% extends 'base.html' %}
{% load static %}
{% block scripts %}
<script src="{% static 'scripts/appListener.js' %}" defer></script>

<script
    src="https://code.jquery.com/jquery-3.4.1.min.js"
    integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
    crossorigin="anonymous">
</script>

{% endblock %}
{% block content %}

<h2 class="txt-center title">{{ application.company }}'s Application</h2>

<div class="center container-lg container-sml">
        <p class="txt-medium"> Company:</p>
        <p class="txt-sml">{{ application.company }}</p>
        <p class="txt-medium">Job Title:</p>
        <p class="txt-sml">{{ application.jobtitle }}</p>
        <p class="txt-medium">Job Listing:</p>
        <p class="txt-sml">{{ application.joblisting }}</p>
        <p class="txt-medium">Resume:</p>
        <a href="{{ application.resume }}" class="txt-sml">{{ application.resume }}</a>
        <p class="txt-medium">Applied:</p>
        <p class="txt-sml">{{ application.applied }}</p>
        <p class="txt-medium">Apply Date:</p>
        <p class="txt-sml">{{ application.applicationDate }}</p>
        <p class="txt-medium">Apply By:</p>
        <p class="txt-sml">{{ application.dueDate }}</p>
        <p class="txt-medium">Notes:</p>
        <p class="txt-sml">{{ application.notes }}</p>

    <div class="flex">
        <button class="btn center txt-sml btn-md forced-margin"><a href="{% url 'applications_update' application.id %}">Edit</a></button>
        <button class="btn center txt-sml btn-md forced-margin"><a href="{% url 'applications_delete' application.id %}">Delete</a></button>
        <button class="btn center txt-sml btn-md forced-margin" id='landmark-btn'>Add Event</button>
    </div>
    <div class='hidden' id='landmark-form'>
        <form method='POST' action='{% url "add_landmark" application.id %}'>
        {% csrf_token %}
        {{ landmark_form.as_p }}
        <input type='submit' class='btn' value='Add Landmark'>
        </form>
    </div>
    <div>
    {% for landmark in application.landmark_set.all %}
        <div class='card'>
            <p>{{ landmark.name }}
            {% if landmark.start_date_time %}
                 on {{landmark.start_date_time}}
            {% endif %}
            {% if landmark.end_date_time %}
                until {{ landmark.end_date_time }}
            {% endif %}
            {% if landmark.location %}
                at {{ landmark.location }}
            {% endif %}
             for the {{ application.jobtitle }} position at {{ application.company }}. 
             {% if landmark.followup %}
                You have a follow-up reminder scheduled for {{ landmark.followup }}
            {% endif %}
            </p>
            <button class="btn center txt-sml btn-md forced-margin"><a href="{% url 'landmarks_update' landmark.id %}">Edit</a></button>
            <button class="btn center txt-sml btn-md forced-margin"><a href="{% url 'landmarks_delete' landmark.id %}">Delete</a></button>
        </div>
    {% endfor %}
    </div>
</div>

{% endblock %}
